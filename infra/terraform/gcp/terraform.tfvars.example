# Google Cloud Platform Configuration
# Copy this file to terraform.tfvars and fill in your values
# DO NOT commit terraform.tfvars to version control

project_id     = "your-gcp-project-id"
region         = "us-central1"
environment    = "production"
service_name   = "af-auth"
container_image = "us-central1-docker.pkg.dev/your-gcp-project-id/af-auth/af-auth:latest"

# Networking
enable_private_networking = true
vpc_cidr                 = "10.0.0.0/24"

# Database Configuration
database_name            = "af_auth"
database_user            = "af_auth_user"
database_password        = "CHANGE_ME_USE_SECRET_MANAGER"  # Use Secret Manager in production
database_tier            = "db-f1-micro"  # For production, consider db-n1-standard-1 or higher
database_version         = "POSTGRES_15"
backup_enabled           = true
backup_retention_days    = 7
high_availability        = false  # Set to true for production with regional deployment
enable_ssl               = true

# Redis Configuration
enable_redis             = true
redis_tier               = "BASIC"  # Use STANDARD_HA for production with high availability
redis_memory_size_gb     = 1
redis_version            = "REDIS_7_0"

# Cloud Run Configuration
container_port           = 3000
cpu_limit                = "1000m"  # 1 CPU
memory_limit             = "512Mi"
min_instances            = 0  # Set to 1+ for production to avoid cold starts
max_instances            = 10
concurrency              = 80
timeout_seconds          = 300
allow_public_access      = true

# Environment Variables (non-sensitive)
environment_variables = {
  LOG_LEVEL                                       = "info"
  LOG_PRETTY                                      = "false"
  METRICS_ENABLED                                 = "true"
  METRICS_COLLECT_DEFAULT                         = "true"
  JWT_EXPIRES_IN                                  = "30d"
  SESSION_MAX_AGE_MS                              = "600000"
  GITHUB_CALLBACK_URL                             = "https://your-service-url/auth/github/callback"
  BASE_URL                                        = "https://your-service-url"
  ADMIN_CONTACT_EMAIL                             = "admin@example.com"
  ADMIN_CONTACT_NAME                              = "Administrator"
  CSP_ENABLED                                     = "true"
  HSTS_ENABLED                                    = "true"
  RATE_LIMIT_AUTH_WINDOW_MS                       = "900000"
  RATE_LIMIT_AUTH_MAX                             = "10"
  RATE_LIMIT_JWT_WINDOW_MS                        = "900000"
  RATE_LIMIT_JWT_MAX                              = "100"
  DB_SSL_ENABLED                                  = "true"
  DB_SSL_REJECT_UNAUTHORIZED                      = "true"
  COOKIE_SECURE                                   = "true"
  JWT_KEY_ROTATION_INTERVAL_DAYS                  = "180"
  GITHUB_TOKEN_ENCRYPTION_KEY_ROTATION_INTERVAL_DAYS = "90"
  SERVICE_API_KEY_ROTATION_INTERVAL_DAYS          = "365"
}

# Secret Environment Variables (from Google Secret Manager)
# Create secrets in Secret Manager first, then reference them here
secret_environment_variables = {
  GITHUB_CLIENT_ID                = "github-client-id"
  GITHUB_CLIENT_SECRET            = "github-client-secret"
  SESSION_SECRET                  = "session-secret"
  JWT_PRIVATE_KEY                 = "jwt-private-key"
  JWT_PUBLIC_KEY                  = "jwt-public-key"
  GITHUB_TOKEN_ENCRYPTION_KEY     = "github-token-encryption-key"
  METRICS_AUTH_TOKEN              = "metrics-auth-token"
}
